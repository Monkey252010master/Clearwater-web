<main>
  <div class="status-section">
    <div id="playerStatus" class="player-status">
      ðŸ‘¥ Live Players: <span id="playerCount">--</span>
    </div>

    <div class="session-status ssd">
      ðŸ”´ Session Shut Down
    </div>
  </div>
</main>

<script>
  async function fetchPlayerCount() {
    try {
      const response = await fetch("https://api.policeroleplay.community/v1/server/status", {
        method: "GET",
        headers: {
          "Server-Key": "NGZgZZKUEpfJSCSCwOkO-sEarVbjnxzHoinPxyChXBbvpmWopIIwVJuTNtpME"
        }
      });

      const data = await response.json();
      console.log("ERLC API Response:", data);

      const count = Array.isArray(data?.players) ? data.players.length : 0;
      const countSpan = document.getElementById("playerCount");
      const statusBox = document.getElementById("playerStatus");

      countSpan.textContent = count;

      // Reset classes
      statusBox.classList.remove("low", "medium", "high");

      // Apply color class based on count
      if (count <= 5) {
        statusBox.classList.add("low");
      } else if (count <= 15) {
        statusBox.classList.add("medium");
      } else {
        statusBox.classList.add("high");
      }

    } catch (error) {
      console.error("Error fetching player count:", error);
      document.getElementById("playerCount").textContent = "N/A";
    }
  }

  fetchPlayerCount();
  setInterval(fetchPlayerCount, 30000);
</script>
